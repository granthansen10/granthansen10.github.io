[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "My name is Grant Hansen. I am a junior broadcasting and sports media major at the University of Nebraska-Lincoln. I cover Husker baseball with HuskerOnline as a part of the On3 network of fan sites. I also am the play-by-play voice of the Midland Warriors in basketball and football. On this website, you can find my data journalism work."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Hansen’s Data Dive",
    "section": "",
    "text": "huskers\n\n\ncode\n\n\nanalysis\n\n\n\n\n\n\n\n\n\n\n\nDec 5, 2022\n\n\nGrant Hansen\n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n\n\nhuskers\n\n\ncode\n\n\nanalysis\n\n\n\n\n\n\n\n\n\n\n\nNov 7, 2022\n\n\nGrant Hansen\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/the-frost-first-drive-effect/index.html",
    "href": "posts/the-frost-first-drive-effect/index.html",
    "title": "The Frost First Drive Effect",
    "section": "",
    "text": "That’s a statement that likely every Husker fan who has followed the program closely in the last five years would agree with. Who could forget the first drive against Ohio State in 2018? Or the glorious four-play explosion of offense on the opening drive in the 2020 trip to Columbus that was punctuated by a Luke McCaffery 47 yard run? Or perhaps last week’s loss to Minnesota?\nAll of these instances have two things in common. Nebraska appeared to be invincible on script. Once the Huskers got off, they couldn’t sustain any momentum. They lost.\nSo is the first drive mayhem that was a major piece of the Scott Frost era real? Is it just a myth based in recency bias and dashed expectations?\nWell, the answer is somewhere in between.\n\n\nCode\nlibrary(tidyverse)\nlibrary(cfbfastR)\nlibrary(ggrepel)\nlibrary(ggalt)\n\ndrives22<-cfbd_drives(\n  2022,\n  season_type = \"regular\"\n) %>%  \n  mutate(season=2022)\n\ndrives18<-cfbd_drives(\n  2018,\n  season_type = \"regular\"\n)%>%  \n  mutate(season=2018)\n\ndrives19<-cfbd_drives(\n  2019,\n  season_type = \"regular\"\n)%>%  \n  mutate(season=2019)\n\ndrives20<-cfbd_drives(\n  2020,\n  season_type = \"regular\"\n)%>%  \n  mutate(season=2020)\n\ndrives21<-cfbd_drives(\n  2021,\n  season_type = \"regular\"\n)%>%  \n  mutate(season=2021)\n\ndrives<-bind_rows(\n  drives22, drives21, drives20, drives19, drives18\n)\n\nYearlySuccess<-drives %>% \n  filter(drive_number<=2) %>% \n  group_by(offense, season, scoring) %>% \n  summarize(count = n()) %>% \n  pivot_wider(names_from = scoring, values_from = count)%>% \n  replace(is.na(.), 0) %>% \n  mutate(GamesPlayed= `TRUE` + `FALSE`) %>% \n  group_by(offense, season) %>%  \n  summarize(\n  Score=sum(`TRUE`),\n  Total=sum(GamesPlayed)) %>%  \n  mutate(SuccessRate=Score/Total*100) %>% \n  filter(Total>5) %>% \n  arrange(desc(SuccessRate))\n\nnuplustop10<-YearlySuccess %>% \n  filter(offense==\"Nebraska\"|offense==\"Alabama\"|offense==\"Ohio State\"|offense==\"UCF\"|offense==\"Oklahoma\"|offense==\"North Carolina\"|offense==\"Georgia\"|offense==\"LSU\"|offense==\"UAB\"|offense==\"Air Force\"|offense==\"Oklahoma State\")\n\nnucolor<-nuplustop10 %>% filter(offense==\"Nebraska\")\n\nggplot()+\n  geom_line(data = nuplustop10, aes(x=season, y=SuccessRate, group=offense))+\n  geom_line(data = nucolor, aes(x=season, y=SuccessRate, group=offense), color=\"red\")+\n  facet_wrap(~offense)+\n  labs(title = \"Is Nebraska the best opening drive team of the last five years?\", subtitle = \"No, not even close. The Huskers rank No. 43 in the nation, well behind the country's top ten teams.\", y=\"Opening Drive Score %\", x=\"Season\", caption=\"Source: cfbfastR | By: Grant Hansen\")+\n  theme_minimal()+\n  theme(\n    plot.title = element_text(size = 16, face= \"bold\"),\n    axis.title = element_text(size=8),\n    plot.subtitle = element_text(size=11),\n    plot.title.position = \"plot\",\n    panel.grid.minor = element_blank(), \n    axis.text.x = element_text(size=7)\n  )\n\n\n\n\n\nLet’s begin by taking Nebraska’s opening drive score rate throughout the last five years. Any instance of points scored on a team’s first offensive drive counts as an opening drive score (ODS).\nThe Huskers are No. 43 in the country. Certainly not in the bottom half of the FBS, but not good either. Nebraska isn’t the opening drive juggernaut that they can at times seem to be. That’s especially true when compared to the top ten teams of the last five seasons.\nThere are plenty of programs in here that aren’t a surprise such as Alabama and Ohio State. UCF is particularly impressive because of the coaching turnover present in Orlando. It’s also blatantly obvious that LSU suffered a major drop-off from 2019 to 2020 (I wonder why that would be?).\nAll in all, the Huskers just aren’t special here despite a great 2018 for opening drive scores.\n\n\nCode\nRecords18<-cfbd_game_records(2018)\n\nRecords19<-cfbd_game_records(2019)\n\nRecords20<-cfbd_game_records(2020)\n\nRecords21<-cfbd_game_records(2021)\n\nRecords22<-cfbd_game_records(2022)\n\nFiveYearRecords<-bind_rows(Records18, Records19, Records20, Records21, Records22)\n\nFiveYearWinRate<-FiveYearRecords %>% \n  group_by(team) %>% \n  summarize(\n  Total=sum(total_games),\n  Wins=sum(total_wins)\n) %>% \n  mutate(WinPercentage=Wins/Total*100)\n\n\nFiveYearSuccessRate<-drives %>% \n  filter(drive_number<=2) %>% \n  group_by(offense, season, scoring) %>% \n  summarize(count = n()) %>% \n  pivot_wider(names_from = scoring, values_from = count) %>% \n  replace(is.na(.), 0) %>% \n  mutate(GamesPlayed= `TRUE` + `FALSE`) %>% \n  group_by(offense) %>% \n  summarize(\n  Score=sum(`TRUE`),\n  Total=sum(GamesPlayed)) %>%\n  mutate(SuccessRate=Score/Total) %>% \n  filter(Total>40) %>% \n  arrange(desc(SuccessRate))\n\nFiveYearTotals<-bind_rows(FiveYearWinRate, FiveYearSuccessRate)\n\nFiveYearTotals<-FiveYearWinRate %>% inner_join(FiveYearSuccessRate, by=c(\"team\"=\"offense\"))\n\nFiveYearNU<-FiveYearTotals %>% filter(team==\"Nebraska\"|team==\"Alabama\"|team==\"Ohio State\"|team==\"UCF\"|team==\"Oklahoma\"|team==\"North Carolina\"|team==\"Georgia\"|team==\"LSU\"|team==\"UAB\"|team==\"Air Force\"|team==\"Oklahoma State\"|team==\"San Diego State\"|team==\"Iowa\" |team==\"Akron\"| team==\"Michigan\"| team==\"Kansas\" |team==\"Georgia Southern\" | team==\"Northwestern\")\n\nnucolor<-FiveYearTotals %>% filter(team==\"Nebraska\")\n\nggplot()+\n  geom_point(data=FiveYearTotals, aes(x=WinPercentage, y=SuccessRate), color=\"grey\")+\n  geom_point(data=FiveYearNU, aes(x=WinPercentage, y=SuccessRate), color=\"black\")+\n  geom_point(data=nucolor, aes(x=WinPercentage, y=SuccessRate), color=\"#E41C38\")+\n  geom_smooth(data=FiveYearTotals, aes(x=WinPercentage, y=SuccessRate), method = \"lm\", se=FALSE)+\n    geom_text_repel(data=FiveYearNU, aes(x=WinPercentage, y=SuccessRate, label=team))+\n    labs(\n    x=\"Win % Since 2018\", \n    y=\"Opening Drive Score %\", \n    title=\"Nebraska fails to win despite a decent opening drive score rate\", \n    subtitle=\"Compared to other teams in the FBS, Nebraska is vastly underperforming.\", \n    caption=\"Source: cfbfastR | By: Grant Hansen\"\n    )+\n  theme_minimal()+\n    theme(\n    plot.title = element_text(size = 16, face= \"bold\"),\n    axis.title = element_text(size=10),\n    plot.subtitle = element_text(size=11),\n    plot.title.position = \"plot\",\n    panel.grid.minor = element_blank()\n  )\n\n\n\n\n\nLet’s check this metric against the most important stat in sports, win percentage.\nIt probably doesn’t come as a shock to many to see that Nebraska is underperforming here too. Using the fit line, one could predict that Nebraska should be winning roughly 70% of its games based on its ODS.\nIt’s difficult to say if scoring on a first drive is something that good teams do, or something that helps teams win with a higher frequency. The former seems much more likely in this scribe’s opinion. But with everything, there are always outliers.\nIowa and Michigan are great examples of teams that have struggled mightily on opening drives but continue to win at a high level. San Diego State and Georgia Southern are more extreme examples although they do play in an inferior conference.\nNebraska is on the opposite side of the chart to those programs. Not good.\n\n\nCode\ndrivesDB <- drives %>% \n  arrange(offense, game_id) %>% \n  group_by(offense, game_id) %>% \n  mutate(team_drive = row_number())\n\nopeningdrives <- drives %>% \n  filter(drive_number == 1 | drive_number == 2) %>% \n  filter(scoring == TRUE)\n\nod <- openingdrives %>% \n  select(game_id)\n\nDBDRIVESCHART<-drivesDB %>% \n  inner_join(od) %>% \n  filter(scoring == TRUE) %>% \n  mutate(whichscore = row_number()) %>%\n  filter(whichscore == 2) %>%\n  group_by(offense) %>% summarize(next_score = mean(team_drive)) %>% mutate(FirstDrive=1)\n\n\nJoining, by = \"game_id\"\n\n\nCode\nDBFiltered<-DBDRIVESCHART %>% \nfilter(offense==\"Nebraska\"|offense==\"Alabama\"|offense==\"Ohio State\"|offense==\"UCF\"|offense==\"Oklahoma\"|offense==\"North Carolina\"|offense==\"Georgia\"|offense==\"LSU\"|offense==\"UAB\"|offense==\"Air Force\"|offense==\"Oklahoma State\"|offense==\"San Diego State\"|offense==\"Iowa\" |offense==\"Akron\"| offense==\"Michigan\"| offense==\"Kansas\" |offense==\"Georgia Southern\" | offense==\"Northwestern\")\n\nnuDB<-DBDRIVESCHART %>% filter(offense==\"Nebraska\")\n\niwDB<-DBDRIVESCHART %>% filter(offense==\"Iowa\")\n\nmiDB<-DBDRIVESCHART %>% filter(offense==\"Michigan\")\n\ngsDB<-DBDRIVESCHART %>% filter(offense==\"Georgia Southern\")\n\nggplot()+\n  geom_dumbbell(\n    data = DBFiltered,\n    aes(y=reorder(offense, next_score), x=FirstDrive, xend=next_score),\n    size= 2,\n    color=\" dark grey\"\n  )+\n    geom_dumbbell(\n    data = nuDB,\n    aes(y=reorder(offense, next_score), x=FirstDrive, xend=next_score),\n    size= 2,\n    color=\"#E41C38\"\n  )+\n   geom_dumbbell(\n    data = iwDB,\n    aes(y=reorder(offense, next_score), x=FirstDrive, xend=next_score),\n    size= 2,\n    color=\"#FFCD00\"\n  )+\n     geom_dumbbell(\n    data = miDB,\n    aes(y=reorder(offense, next_score), x=FirstDrive, xend=next_score),\n    size= 2,\n    color=\"#00274C\"\n  )+\n       geom_dumbbell(\n    data = gsDB,\n    aes(y=reorder(offense, next_score), x=FirstDrive, xend=next_score),\n    size= 2,\n    color=\"#87714D\"\n  )+\n   labs(\n    x=\"Average Drives Unitl Second Score\", \n    y=\"\", \n    title=\"If Nebraska manages to score on its first drive...\", \n    subtitle=\"The Huskers take a signficant amount of possesions to score again. Even longer than teams\\n with worse opening drive success rates such as Iowa, Georgia Southern and Michigan.\", \n    caption=\"Source: cfbfastR | By: Grant Hansen\")+\n  theme_minimal()+\n      theme(\n    plot.title = element_text(size = 18, face= \"bold\"),\n    axis.title = element_text(size=10),\n    plot.subtitle = element_text(size=10),\n    plot.title.position = \"plot\",\n    panel.grid.minor = element_blank())\n\n\n\n\n\nLet’s take a measurement of Nebraska’s opening drive hangover.\nIt’s coming. Everyone in Memorial Stadium can sense it each week. They’ve been conditioned.\nOnce Nebraska scores, it takes the Huskers on average 4.3 drives to score again. Adjustment from the script that is practiced throughout the week to the regular course of the game is…difficult. There are three teams that have a worse ODS than Nebraska, but are much more capable of scoring again after a first-drive score. Those teams are Iowa, Michigan and Georgia Southern.\nSo, is the Frost Era First Drive Effect real?\nThe answer is, yes. Mostly. Nebraska isn’t the best in the country on opening drives but the crash that follows the good openers is very very real.\nBy far, Nebraska has scored a touchdown on their opening drive more than any other outcome in the last five seasons. The Huskers have had no issue scoring on the first drive either. That’s great.\nThe two most damning numbers are the difference between Nebraska’s ODS and the fit line, and that it takes Nebraska over four drives (almost a quarter) to score again.\nIt’s indicative of the failures brought to bear by the Husker coaching staff in the last few years. Failures to support the team off script and failure to adjust."
  },
  {
    "objectID": "posts/whipples-world-analyzing-nebraskas-2022-playcalling/index.html",
    "href": "posts/whipples-world-analyzing-nebraskas-2022-playcalling/index.html",
    "title": "Whipple’s World: Analyzing Nebraska’s 2022 Playcalling",
    "section": "",
    "text": "Code\nlibrary(cfbfastR)\nlibrary(tidyverse)\nlibrary(ggrepel)\nlibrary(ggalt)\nlibrary(waffle)\n\nplays <- load_cfb_pbp(2022)\n\nfumbles<-plays %>% filter(offense_play == \"Nebraska\", grepl(\"Fumble\", play_type)) \n\nnebraskaplays<-plays %>% \n  filter(offense_play == \"Nebraska\") %>%\n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\"\n    )) %>% group_by(run_pass) %>%\n  tally()\n\nwhipthirdshort<-plays %>% \n  filter(offense_play == \"Nebraska\", down == \"3\" | down==\"4\", distance< 4 ) %>%\n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\"\n    )) %>% group_by(run_pass) %>%\n  tally()\n\n\nnulateshort<-c(\"Rushing Plays\"=62, \"Passing Plays\"= 38.3)\n\nnurunpass<-c(\"Rushing Plays\"=51.07, \"Passing Plays\"=48.9)\n\niron(\nwaffle(\n  nurunpass,\n  rows = 5,\n  colors = c(\"red\", \"black\")) +\n  labs(\n    x= \"1 square= 1%\",\n    title = \"Whipple's playcalling was squarly middle of the road\",\n    subtitle = \"Nebraska has ran the football 51% of the time this season.\") +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n  ),\n\nwaffle(\n  nulateshort,\n  rows = 5,\n  colors= c(\"red\", \"black\")) +\n    labs(\n    x= \"1 square= 1%\",\n   title = \"Whipple ran it more on short, key downs\",\n    subtitle = \"The ratio further favors the rushing attack on third or fourth down and less than four (62%).\",\n      caption=\"Source: cfbfastR | Graphic by Grant Hansen\") +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n))\n\n\n\n\n\nTEXT\n\n\nCode\nBigTenRatio<-plays %>% \n  filter(offense_conference == \"Big Ten\") %>%\n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\"\n    )) %>% group_by(run_pass) %>%\n  tally()\n\nbigrunpass<-c(\"Rushing Plays\"= 51.6, \"Passing Plays\" = 48.3)\n\nbigthirdshort<-plays %>% \n  filter(offense_conference == \"Big Ten\", down == \"3\" | down==\"4\", distance< 4 ) %>%\n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\"\n    )) %>% group_by(run_pass) %>%\n  tally()\n\nbiglateshort<- c(\"Rushing Plays\"= 72.4, \"Passing Plays\" = 27.5)\n\niron(\nwaffle(\n  bigrunpass,\n  rows = 5,\n  colors = c(\"blue\", \"grey\")) +\n  labs(\n    x= \"1 square= 1%\",\n    title = \"The Big Ten also found itself in balence\",\n    subtitle = \"Whipple is spot on with the rest of his Big Ten collegues (51% run).\") +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n  ),\n\nwaffle(\n  biglateshort,\n  rows = 5,\n  colors= c(\"blue\", \"grey\")) +\n    labs(\n    x= \"1 square= 1%\",\n   title = \"The Big Ten keeps it conservative on key downs\",\n    subtitle = \"This is where Whipple breaks from the crowd. The rest of the conference\\n runs it here nearly 75% of the time.\",\n      caption=\"Source: cfbfastR | Graphic by Grant Hansen\") +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n))\n\n\n\n\n\nTEXT\n\n\nCode\nnuweektoweek<-plays %>% \n  filter(offense_play == \"Nebraska\") %>% \n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\",\n    )) %>% group_by(week, run_pass, def_pos_team) %>% filter(run_pass != \"Other\")%>%  mutate(week = case_when(\n    def_pos_team == \"Northwestern\" ~ 0,\n    TRUE ~ as.numeric(week)\n  )) %>% \n  tally() \n\nggplot()+\n  geom_bar(data = nuweektoweek, aes(x=reorder(def_pos_team, week), weight=n, fill=run_pass)) +\n  scale_fill_manual(values = c(\"black\", \"red\"), name= \"Play Type\")+\n    labs(\n    x=\"\", \n    y=\"Total Plays\", \n    title=\"Nebraska was balanced almost all season\", \n    subtitle=\"Scott Frost was fired following the loss to Georgia Southern. But, there is little to no change\\n in the run-pass ratio once Frost is off the board.\", \n    caption=\"Source: cfbfastR | By: Grant Hansen\") +\n    theme_minimal()+\n      theme(\n    plot.title = element_text(size = 18, face= \"bold\"),\n    axis.title = element_text(size=10),\n    plot.subtitle = element_text(size=10),\n    plot.title.position = \"plot\",\n    panel.grid.minor = element_blank())+\n  coord_flip()\n\n\n\n\n\nTEXT\n\n\nCode\nmetrics<-cfbd_metrics_ppa_teams(2022) %>% \n  filter(conference==\"Big Ten\") %>% \n  mutate(gap=as.numeric(off_passing)-as.numeric(off_rushing))\n\nggplot() +\n  geom_dumbbell(\n    data = metrics,\n    aes(y=reorder(team, (gap)), x=as.numeric(off_rushing), xend=as.numeric(off_passing)), \n    size= 2.5,\n    color=\"grey\",\n    colour_x=\"red\",\n    colour_xend= \"black\") +  \n    labs(\n    x=\"Projected Points Added\", \n    y=\"\", \n    title=\"Nebraska's run-pass ratio was balanced,\\n its offensive efficency wasn't\", \n    subtitle=\"Red dots equal projected points added from rushing plays. Black dots represent passing plays.\", \n    caption=\"Source: cfbfastR | By: Grant Hansen\")+\n  theme_minimal()+\n      theme(\n    plot.title = element_text(size = 18, face= \"bold\"),\n    axis.title = element_text(size=10),\n    plot.subtitle = element_text(size=10),\n    plot.title.position = \"plot\",\n    panel.grid.minor = element_blank())\n\n\n\n\n\nTEXT"
  },
  {
    "objectID": "Whipple Offense Project.html",
    "href": "Whipple Offense Project.html",
    "title": "Hansen's Data Dive",
    "section": "",
    "text": "plays <- load_cfb_pbp(2022)\n\n\nfumbles<-plays %>% filter(offense_play == \"Nebraska\", grepl(\"Fumble\", play_type)) \n\nNebraska has had 9 fumbles this season.\nPass Plays: 5 Run Plays: 4\n\nplays %>% \n  filter(offense_play == \"Nebraska\") %>%\n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\"\n    )) %>% group_by(run_pass) %>%\n  tally()\n\n# A tibble: 3 × 2\n  run_pass     n\n  <chr>    <int>\n1 Other      280\n2 Pass       362\n3 Run        379\n\n\n\nwhipthirdshort<-plays %>% \n  filter(offense_play == \"Nebraska\", down == \"3\" | down==\"4\", distance< 4 ) %>%\n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\"\n    )) %>% group_by(run_pass) %>%\n  tally()\n\n\nhead(whipthirdshort)\n\n# A tibble: 3 × 2\n  run_pass     n\n  <chr>    <int>\n1 Other       27\n2 Pass        19\n3 Run         31\n\n\nOne of Nebraska’s fumbles occurred on third and short.\n\nnulateshort<-c(\"Rushing Plays\"=62, \"Passing Plays\"= 38.3)\n\n\nnurunpass<-c(\"Rushing Plays\"=51.07, \"Passing Plays\"=48.9)\n\n\niron(\nwaffle(\n  nurunpass,\n  rows = 5,\n  colors = c(\"red\", \"black\")) +\n  labs(\n    x= \"1 square= 1%\",\n    title = \"The Whipple Run-Pass Ratio\",\n    subtitle = \"Nebraska has ran the football 51% of the time this season.\") +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n  ),\n\nwaffle(\n  nulateshort,\n  rows = 5,\n  colors= c(\"red\", \"black\")) +\n    labs(\n    x= \"1 square= 1%\",\n   title = \"Whipple on third/fourth down and less than four\",\n    subtitle = \"The ratio further favors the run on short, key downs (62%).\",\n      caption=\"Source: cfbfastR | Graphic by Grant Hansen\") +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n))\n\n\n\n\nNext let’s make the Big Ten waffle iron.\n\nBigTenRatio<-plays %>% \n  filter(offense_conference == \"Big Ten\") %>%\n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\"\n    )) %>% group_by(run_pass) %>%\n  tally()\n\n\nhead(BigTenRatio)\n\n# A tibble: 3 × 2\n  run_pass     n\n  <chr>    <int>\n1 Other     3755\n2 Pass      5287\n3 Run       5639\n\n\nNow I need to subtract Nebraska’s plays. 363 pass, 379 run (742 total) Counting fumbles. 10,186 total plays subtracting Nebraska’s.\n\nbigrunpass<-c(\"Rushing Plays\"= 51.6, \"Passing Plays\" = 48.3)\n\n\nbigthirdshort<-plays %>% \n  filter(offense_conference == \"Big Ten\", down == \"3\" | down==\"4\", distance< 4 ) %>%\n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\"\n    )) %>% group_by(run_pass) %>%\n  tally()\n\n\nhead(bigthirdshort)\n\n# A tibble: 3 × 2\n  run_pass     n\n  <chr>    <int>\n1 Other      360\n2 Pass       234\n3 Run        592\n\n\nNebraska 19 pass, 31 run. 774 total B10 plays without Nebraska.\n\nbiglateshort<- c(\"Rushing Plays\"= 72.4, \"Passing Plays\" = 27.5)\n\n\niron(\nwaffle(\n  bigrunpass,\n  rows = 5,\n  colors = c(\"blue\", \"grey\")) +\n  labs(\n    x= \"1 square= 1%\",\n    title = \"The Big Ten Run-Pass Ratio\",\n    subtitle = \"Whipple is spot on with the rest of his Big Ten collegues.\") +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n  ),\n\nwaffle(\n  biglateshort,\n  rows = 5,\n  colors= c(\"blue\", \"grey\")) +\n    labs(\n    x= \"1 square= 1%\",\n   title = \"The Big Ten on third or fourth down and less than four\",\n    subtitle = \"This is where Whipple breaks from the crowd. The rest of the conference\\n runs it here nearly 75% of the time.\",\n      caption=\"Source: cfbfastR | Graphic by Grant Hansen\") +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n))\n\n\n\n\nTime to make a stacked bar chart showing Nebraska’s Run-Pass Ratio week by week.\n\nnuweektoweek<-plays %>% \n  filter(offense_play == \"Nebraska\") %>% \n  mutate(\n    run_pass = case_when(\n      grepl(\"Pass\", play_type) == TRUE ~ \"Pass\",\n      play_type == \"Sack\" ~ \"Pass\",\n      grepl(\"Interception\", play_type) == TRUE ~ \"Pass\",\n      grepl(\"Rush\", play_type) == TRUE ~ \"Run\",\n      TRUE ~ \"Other\",\n    )) %>% group_by(week, run_pass, def_pos_team) %>% filter(run_pass != \"Other\")%>%  mutate(week = case_when(\n    def_pos_team == \"Northwestern\" ~ 0,\n    TRUE ~ as.numeric(week)\n  )) %>% \n  tally() \n\n\nhead(nuweektoweek)\n\n# A tibble: 6 × 4\n# Groups:   week, run_pass [6]\n   week run_pass def_pos_team         n\n  <dbl> <chr>    <chr>            <int>\n1     0 Pass     Northwestern        43\n2     0 Run      Northwestern        29\n3     1 Pass     North Dakota        22\n4     1 Run      North Dakota        37\n5     2 Pass     Georgia Southern    36\n6     2 Run      Georgia Southern    45\n\n\n\nggplot()+\n  geom_bar(data = nuweektoweek, aes(x=reorder(def_pos_team, week), weight=n, fill=run_pass)) +\n  scale_fill_manual(values = c(\"black\", \"red\"), name= \"Play Type\")+\n    labs(\n    x=\"\", \n    y=\"Total Plays\", \n    title=\"Nebraska was balanced almost all season\", \n    subtitle=\"Scott Frost was fired following the loss to Georgia Southern. But, there is little to no change\\n in the run-pass ratio once Frost is off the board.\", \n    caption=\"Source: cfbfastR | By: Grant Hansen\") +\n    theme_minimal()+\n      theme(\n    plot.title = element_text(size = 18, face= \"bold\"),\n    axis.title = element_text(size=10),\n    plot.subtitle = element_text(size=10),\n    plot.title.position = \"plot\",\n    panel.grid.minor = element_blank())+\n  coord_flip()\n\n\n\n\n\nmetrics<-cfbd_metrics_ppa_teams(2022) %>% \n  filter(conference==\"Big Ten\") %>% \n  mutate(gap=as.numeric(off_passing)-as.numeric(off_rushing))\n\nProjected points added dumbbell chart.\n\nggplot() +\n  geom_dumbbell(\n    data = metrics,\n    aes(y=reorder(team, (gap)), x=as.numeric(off_rushing), xend=as.numeric(off_passing)), \n    size= 2.5,\n    color=\"grey\",\n    colour_x=\"red\",\n    colour_xend= \"black\") +  \n    labs(\n    x=\"Projected Points Added\", \n    y=\"\", \n    title=\"Nebraska's run-pass ratio was balanced,\\n its offensive efficency wasn't\", \n    subtitle=\"Red dots equal projected points added from rushing plays. Black dots represent passing plays.\", \n    caption=\"Source: cfbfastR | By: Grant Hansen\")+\n  theme_minimal()+\n      theme(\n    plot.title = element_text(size = 18, face= \"bold\"),\n    axis.title = element_text(size=10),\n    plot.subtitle = element_text(size=10),\n    plot.title.position = \"plot\",\n    panel.grid.minor = element_blank())"
  }
]